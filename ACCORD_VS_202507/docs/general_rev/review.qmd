---
title: "Spatial Verification Techniques for Extreme Events: A Review"
author: "Carlos Peralta"
date: today
format: 
  html:
    toc: true
    toc-depth: 3
    code-fold: true
    theme: cosmo
jupyter: python3
---

# Introduction

Brief overview of the "double penalty problem" in traditional gridpoint-based verification and why spatial verification techniques are needed for high-resolution forecasts of extreme events.

## The Double Penalty Problem
- Traditional metrics penalize forecasts twice for spatial displacement
- Example: correct intensity/timing but wrong location → poor scores
- Need for spatial verification methods that don't require exact gridpoint matching

# Classification of Spatial Verification Techniques

Based on Gilleland et al. (2009), spatial verification techniques fall into four main categories:

## 1. Fuzzy/Neighborhood Verification
- **Concept**: Require approximate agreement in space, time, intensity
- **Approach**: Measure strength of agreement as closeness requirements vary
- **Examples**: 
  - Neighborhood verification methods
  - Fractions Skill Score (FSS)
- **Pros**: 
  - ✓ Intuitive and easy to implement
- **Cons**: 
  - ✗ May lose information about specific displacement patterns


## 2. Scale-Decomposition Techniques
- **Concept**: Assess forecast skill at different spatial scales by filtering the fields.
- **Approach**: Apply spatial filters (e.g., Fourier, wavelet) to separate and analyze features by scale.
- **Examples**:
  - Intensity-Scale technique (Casati et al. 2004)
  - Wavelet-based verification methods
- **Pros**:
  - ✓ Reveals at which scales the model performs well or poorly
  - ✓ Helps isolate errors in large-scale vs. small-scale features
- **Cons**:
  - ✗ Can be complex to interpret and implement
  - ✗ May not directly address feature displacement

## 3. Feature-Based/Object-Oriented Techniques
- **Concept**: Identify and compare discrete weather features (objects) in forecasts and observations.
- **Approach**: Detect, match, and analyze properties of corresponding features (e.g., location, size, intensity).
- **Examples**:
  - Ebert & McBride (2000) object-based method
  - MODE (Method for Object-based Diagnostic Evaluation, Davis et al. 2006)
  - SAL (Structure, Amplitude and Location, Wernli and Paulat 2008)
- **Pros**:
  - ✓ Intuitive and effective for well-defined features
  - ✓ Provides detailed diagnostics on feature attributes
- **Cons**:
  - ✗ Challenging to define and match objects, especially in complex fields
  - ✗ May struggle with overlapping or poorly defined features

## 4. Field Verification Techniques (Optical Flow)
- **Concept**: Compare entire spatial fields directly, without decomposing into objects or scales.
- **Approach**: Use algorithms (e.g., optical flow) to morph the forecast field to match the observation, quantifying displacement and amplitude errors.
- **Examples**:
  - Displacement and Amplitude Score (DAS, Keil & Craig 2009)
  - Other optical flow-based methods
- **Pros**:
  - ✓ Avoids need for explicit feature identification or matching
  - ✓ Captures both displacement and amplitude errors in a unified framework
- **Cons**:
  - ✗ Sensitive to algorithm parameters (e.g., search distance)
  - ✗ Computationally intensive and may be less interpretable for complex cases

